<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>jVectorMap demo</title>
  <link rel="stylesheet" href="jquery-jvectormap-2.0.3.css" type="text/css" media="screen"/>
  <script src="jquery-1.12.3.min.js"></script>
  <script src="jquery-jvectormap-2.0.3.min.js"></script>
  <script src="jquery-jvectormap-world-mill-en.js"></script>
  <script src="gdp-data.js"></script>
  <script src="markers.js"></script>
  <!-- <script src="mortality.jsonp"></script> -->
  <!-- <script src="process.js"></script> -->

  </script>

  </script>
  <link rel="stylesheet" href="custom-styles.css" media="screen" title="no title" charset="utf-8">

</head>
<body>
  <div class="map-container">

    <div id="world-map-gdp"  ></div>
    <!-- <script>
    $(function(){
    $('#world-map').vectorMap({map: 'world_mill'});
  });
</script> -->
<script>

$(function(){
  var scope ={};
  scope.bgColor = '#fff';
  scope.scaleColors = ['#fbf0f1','#cb333b'];
  scope.fillColor = '#e7e7e9';
  scope.strokeColor = '#fff';
  scope.strokeWidth = '0.4';
  scope.markerColor = 'aqua'

  $('#world-map-gdp').vectorMap({
    map: 'world_mill_en',
    backgroundColor: scope.bgColor,
    zoomOnScroll: false,
    regionStyle: {
      initial: {
        fill: scope.fillColor,
        stroke: scope.strokeColor,
        "stroke-width": scope.strokeWidth
      }
    },
    markers: markers,
    markerStyle: {
            initial: {
              fill: scope.markerColor,
              stroke: scope.strokeColor
            }
          },
    series: {
      regions: [{
        values: gdpData,
        scale: scope.scaleColors,
        normalizeFunction: 'polynomial'
      }]
      // markers: [{
      //   attribute: fill,
      //
      // }]
    },
    onRegionTipShow: function(e, label, index){
      label.html(label.html()+'<br> (GDP - '+gdpData[index]+')');
    },
    // onMarkerTipShow: function(event, label, code){
    //   label.html("<p>Name:<br>"+ label.html()+"</p>");
    // }
    onMarkerTipShow: function(event, label, index){
      label.html('<h3>'+label.html()+'</h3>'+'<p>'+markers[index].content+'</p>'+'<a href="'+markers[index].link+'">Where we work >></a>');
    }
  });


  // $.getJSON( "mortality.json", function( data ) {
  //  for (var i=0; i<data.length; i++) {
  //    result[data[i].key] = data[i].value;
  //  }
  // //  console.log(result);
  // });
  //
  // $.getJSON( "countries.json", function(isoCountries) {
  //   var countries = isoCountries;
  //   console.log( countries );
  // });

  var mortalityData, countryData;
  $.when(
    $.getJSON( "mortality.json", function(data) {
      mortalityData = data;
    }),
    $.getJSON("countries.json", function( data) {
      countryData = data;
    })
  ).then(function() {
    // var result = {};
    // for (var i=0; i<mortalityData.length; i++) {
    //   for (var i=0; i<countryData.length; i++) {
    //     if (mortalityData[i].key == countryData[i].value) {
    //       result[countryData[i].key] = mortalityData[i].value;
    //     }
    //   }
    // }
    console.log(countryData);

  });

  // $.getJSON( "mortality.json", function( data ) {
  //  var result = {};
  //  for (var i=0; i<data.length; i++) {
  //    $.getJSON( "countries.json", function( isoCountries ) {
  //      for (var i=0; i<isoCountries.length; i++) {
  //        if data[i].key == isoCountries[i].value {
  //          result[isoCountries[i].key] = data[i].value;
  //        }
  //      }
  //      console.log(result);
  //    });




});
</script>
  </div>
</body>
</html>
